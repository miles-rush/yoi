import{e as v,u as b,f as g,h as X,r as s,o as V,c as L,b as u,a as e,w as a,F as Y,i as Z,k as B,l as ee,d as i,t as c,g as le}from"./index.0e20a458.js";const ae={class:"leave-manage"},te={class:"query-form"},oe=i("\u67E5\u8BE2"),ne=i("\u91CD\u7F6E"),re={class:"base-table"},se={class:"action"},pe=i("\u7533\u8BF7\u4F11\u5047"),de=i("\u67E5\u770B"),ue=i("\u4F5C\u5E9F"),ie=i(" - "),me=i("\u53D6 \u6D88"),_e=i("\u786E \u5B9A"),ye={__name:"Leave",setup(ce){const{proxy:m}=le(),T=v({applyState:1}),z=v([{label:"\u5355\u53F7",prop:"orderNo"},{label:"\u4F11\u5047\u65F6\u95F4",prop:"",width:"200px",formatter(o){return b.formateDate(new Date(o.startTime),"yyyy-MM-dd")+" \u5230 "+b.formateDate(new Date(o.endTime),"yyyy-MM-dd")}},{label:"\u4F11\u5047\u65F6\u957F",prop:"leaveTime"},{label:"\u4F11\u5047\u7C7B\u578B",prop:"applyType",formatter(o,l,n){return{1:"\u4E8B\u5047",2:"\u8C03\u4F11",3:"\u5E74\u5047"}[n]}},{label:"\u4F11\u5047\u539F\u56E0",prop:"reasons"},{label:"\u7533\u8BF7\u65F6\u95F4",prop:"createTime",formatter:(o,l,n)=>b.formateDate(new Date(n))},{label:"\u5BA1\u6279\u4EBA",prop:"auditUsers"},{label:"\u5F53\u524D\u5BA1\u6279\u4EBA",prop:"curAuditUserName"},{label:"\u5BA1\u6279\u72B6\u6001",prop:"applyState",formatter:(o,l,n)=>({1:"\u5F85\u5BA1\u6279",2:"\u5BA1\u6279\u4E2D",3:"\u5BA1\u6279\u62D2\u7EDD",4:"\u5BA1\u6279\u901A\u8FC7",5:"\u4F5C\u5E9F"})[n]}]),w=v({pageNum:1,pageSize:10,total:0}),N=g([]),r=v({applyType:1,startTime:"",endTime:"",leaveTime:"0\u5929",reasons:""}),h=g(!1),C=g(!1),x=g("create"),O=v({startTime:[{type:"date",required:!0,message:"\u8BF7\u8F93\u5165\u5F00\u59CB\u65E5\u671F",trigger:"change"}],endTime:[{type:"date",required:!0,message:"\u8BF7\u8F93\u5165\u7ED3\u675F\u65E5\u671F",trigger:"change"}],reasons:[{required:!0,message:"\u8BF7\u8F93\u5165\u4F11\u5047\u539F\u56E0",trigger:["change","blur"]}]}),d=g({});X(()=>{y()});const y=async()=>{let o={...T,...w},{list:l,page:n}=await m.$api.getApplyList(o);N.value=l,w.total=n.total},E=o=>{w.pageNum=o,y()},I=()=>{h.value=!0,x.value="create"},q=o=>{m.$refs[o].resetFields()},M=()=>{h.value=!1,q("dialogForm"),r.leaveTime="0\u5929"},$=(o,l)=>{let{startTime:n,endTime:f}=r;!n||!f||(n>f?(m.$message.error("\u5F00\u59CB\u65E5\u671F\u4E0D\u80FD\u665A\u4E8E\u7ED3\u675F\u65E5\u671F"),r.leaveTime="0\u5929",setTimeout(()=>{r[o]=""},0)):r.leaveTime=(f-n)/(24*60*60*1e3)+1+"\u5929")},R=()=>{m.$refs.dialogForm.validate(async o=>{if(o){let l={...r,action:x.value};await m.$api.leaveOperate(l),m.$message.success("\u7533\u8BF7\u6210\u529F"),M(),y()}})},j=o=>{C.value=!0;let l={...o};l.applyTypeName={1:"\u4E8B\u5047",2:"\u8C03\u4F11",3:"\u5E74\u5047"}[l.applyType],l.time=b.formateDate(new Date(o.startTime),"yyyy-MM-dd")+" \u5230 "+b.formateDate(new Date(o.endTime),"yyyy-MM-dd"),l.applyStateName={1:"\u5F85\u5BA1\u6279",2:"\u5BA1\u6279\u4E2D",3:"\u5BA1\u6279\u62D2\u7EDD",4:"\u5BA1\u6279\u901A\u8FC7",5:"\u4F5C\u5E9F"}[l.applyState],d.value=l},G=async o=>{let l={action:"delete",_id:o};await m.$api.leaveOperate(l),m.$message.success("\u5220\u9664\u6210\u529F"),y()};return(o,l)=>{const n=s("el-option"),f=s("el-select"),p=s("el-form-item"),_=s("el-button"),k=s("el-form"),U=s("el-table-column"),H=s("el-table"),J=s("el-pagination"),F=s("el-date-picker"),D=s("el-col"),K=s("el-row"),P=s("el-input"),A=s("el-dialog"),S=s("el-step"),Q=s("el-steps");return V(),L("div",ae,[u("div",te,[e(k,{ref:"form",inline:!0,model:T},{default:a(()=>[e(p,{label:"\u5BA1\u6279\u72B6\u6001",prop:"applyState"},{default:a(()=>[e(f,{modelValue:T.applyState,"onUpdate:modelValue":l[0]||(l[0]=t=>T.applyState=t)},{default:a(()=>[e(n,{value:"",label:"\u5168\u90E8"}),e(n,{value:1,label:"\u5F85\u5BA1\u6279"}),e(n,{value:2,label:"\u5BA1\u6279\u4E2D"}),e(n,{value:3,label:"\u5BA1\u6279\u62D2\u7EDD"}),e(n,{value:4,label:"\u5BA1\u6279\u901A\u8FC7"}),e(n,{value:5,label:"\u4F5C\u5E9F"})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:a(()=>[e(_,{onClick:y,type:"primary"},{default:a(()=>[oe]),_:1}),e(_,{onClick:l[1]||(l[1]=t=>q("form"))},{default:a(()=>[ne]),_:1})]),_:1})]),_:1},8,["model"])]),u("div",re,[u("div",se,[e(_,{type:"primary",onClick:I},{default:a(()=>[pe]),_:1})]),e(H,{data:N.value},{default:a(()=>[(V(!0),L(Y,null,Z(z,t=>(V(),B(U,{key:t.prop,prop:t.prop,label:t.label,width:t.width,formatter:t.formatter},null,8,["prop","label","width","formatter"]))),128)),e(U,{label:"\u64CD\u4F5C",width:"150"},{default:a(t=>[e(_,{size:"small",onClick:W=>j(t.row)},{default:a(()=>[de]),_:2},1032,["onClick"]),[1,2].includes(t.row.applyState)?(V(),B(_,{key:0,type:"danger",size:"small",onClick:W=>G(t.row._id)},{default:a(()=>[ue]),_:2},1032,["onClick"])):ee("",!0)]),_:1})]),_:1},8,["data"]),e(J,{class:"pagination",background:"",layout:"prev, pager, next",total:w.total,onCurrentChange:E},null,8,["total"])]),e(A,{title:"\u7533\u8BF7\u4F11\u5047",modelValue:h.value,"onUpdate:modelValue":l[8]||(l[8]=t=>h.value=t),width:"70%"},{footer:a(()=>[e(_,{onClick:M},{default:a(()=>[me]),_:1}),e(_,{onClick:R,type:"primary"},{default:a(()=>[_e]),_:1})]),default:a(()=>[e(k,{ref:"dialogForm",model:r,rules:O,"label-width":"120px"},{default:a(()=>[e(p,{label:"\u4F11\u5047\u7C7B\u578B",prop:"applyType",required:""},{default:a(()=>[e(f,{modelValue:r.applyType,"onUpdate:modelValue":l[2]||(l[2]=t=>r.applyType=t)},{default:a(()=>[e(n,{label:"\u4E8B\u5047",value:1}),e(n,{label:"\u8C03\u4F11",value:2}),e(n,{label:"\u5E74\u5047",value:3})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"\u4F11\u5047\u65F6\u95F4",prop:"applyType",required:""},{default:a(()=>[e(K,null,{default:a(()=>[e(D,{span:8},{default:a(()=>[e(p,{prop:"startTime",required:""},{default:a(()=>[e(F,{modelValue:r.startTime,"onUpdate:modelValue":l[3]||(l[3]=t=>r.startTime=t),type:"date",placeholder:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65E5\u671F",onChange:l[4]||(l[4]=t=>$("startTime"))},null,8,["modelValue"])]),_:1})]),_:1}),e(D,{style:{"margin-left":"10px"},span:1},{default:a(()=>[ie]),_:1}),e(D,{span:8},{default:a(()=>[e(p,{prop:"endTime",required:""},{default:a(()=>[e(F,{modelValue:r.endTime,"onUpdate:modelValue":l[5]||(l[5]=t=>r.endTime=t),type:"date",placeholder:"\u8BF7\u9009\u62E9\u7ED3\u675F\u65E5\u671F",onChange:l[6]||(l[6]=t=>$("endTime"))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,{label:"\u4F11\u5047\u65F6\u957F",required:""},{default:a(()=>[i(c(r.leaveTime),1)]),_:1}),e(p,{label:"\u4F11\u5047\u539F\u56E0",prop:"reasons",required:""},{default:a(()=>[e(P,{type:"textarea",row:3,placeholder:"\u8BF7\u8F93\u5165\u4F11\u5047\u539F\u56E0",modelValue:r.reasons,"onUpdate:modelValue":l[7]||(l[7]=t=>r.reasons=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(A,{title:"\u7533\u8BF7\u4F11\u5047\u8BE6\u60C5",width:"50%",modelValue:C.value,"onUpdate:modelValue":l[9]||(l[9]=t=>C.value=t)},{default:a(()=>[e(Q,{active:d.value.applyState>2?3:d.value.applyState,"destroy-on-close":"","align-center":""},{default:a(()=>[e(S,{title:"\u5F85\u5BA1\u6279"}),e(S,{title:"\u5BA1\u6279\u4E2D"}),e(S,{title:"\u5BA1\u6279\u901A\u8FC7/\u62D2\u7EDD"})]),_:1},8,["active"]),e(k,{"label-width":"120px","label-suffix":":"},{default:a(()=>[e(p,{label:"\u4F11\u5047\u7C7B\u578B"},{default:a(()=>[u("div",null,c(d.value.applyTypeName),1)]),_:1}),e(p,{label:"\u4F11\u5047\u65F6\u95F4"},{default:a(()=>[u("div",null,c(d.value.time),1)]),_:1}),e(p,{label:"\u4F11\u5047\u65F6\u957F"},{default:a(()=>[u("div",null,c(d.value.leaveTime),1)]),_:1}),e(p,{label:"\u4F11\u5047\u539F\u56E0"},{default:a(()=>[u("div",null,c(d.value.reasons),1)]),_:1}),e(p,{label:"\u5BA1\u6279\u72B6\u6001"},{default:a(()=>[u("div",null,c(d.value.applyStateName),1)]),_:1}),e(p,{label:"\u5BA1\u6279\u4EBA"},{default:a(()=>[u("div",null,c(d.value.curAuditUserName),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{ye as default};
